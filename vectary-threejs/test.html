<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <script>

  			// debug = document.getElementById("debug"); // !!!!!  Debug  !!!!!
        // ---------------------------------------------------
        var point;        	// ein einzelner Punkt
        var points;       	// Geometrie ( enthaelt die Punkte als "Knoten" ) 
        var pointSystem;  	// System der Punkte (ohne weitere Dinge wie bei den Koerpern)
        var pointCount;   	// Anzahl der Punkte (kann sehr gross sein)
        var pointsMaterial;	// Material der Punkte, auch die Groesse des Punktes wird dort festgelegt
    
            pointCount = 30000;            		 	// Anzahl der Punkte (Schneeflocken)	
            points = new THREE.Geometry();			// eine allgemeine Geometrie fuer die Punkte erzeugen	
          var pointLoader = new THREE.TextureLoader(); // ein Lader fuer die Textur	
          pointLoader.load("./assets/IMG/snow.jpg", function(texture){   // Textur laden und damit gleich Punktesystem erzeugen
            pointsMaterial = new THREE.PointsMaterial({	size: 21, color: 0xcccccc, map: texture, transparent: true, opacity: 0.95 });
            for (var p = 0; p < pointCount; p++) { 	 // zufaellige Koordinaten erzeugen
              x = Math.random() * 4000 - 2000;
              y = Math.random() * 2000 -  500;
              z = Math.random() * 2000 - 2000;
              point = new THREE.Vector3(x, y, z); // einzelnen Punkt erzeugen (als Ortsvektor seiner Koordinaten)
              points.vertices.push(point);        // Punkt als Knoten der Punkte-Geometrie hinzufuegen
            }
            // System der Punkte
              pointSystem = new THREE.Points(	points,	pointsMaterial);	//  entsprechend THREE.Mesh	bei Koerpern
            // zur Szene hinzufuegen
            scene.add(pointSystem); 
            pointSystem.rotation.x = 0.9;
          });	  
        // Schneemann
          var materialOne 	= new THREE.MeshBasicMaterial( { color: 0xffffff } );	
          var materialTwo  	= new THREE.MeshBasicMaterial( { color: 0xff1133 } );
          var materialThree	= new THREE.MeshBasicMaterial( { color: 0x000000 } );
          var materialFour= new THREE.MeshBasicMaterial( { color: 0x222222 , side:THREE.DoubleSide} );	
          var flake = new THREE.Mesh( new THREE.SphereGeometry( 20, 32, 32 ),materialOne );	
          scene.add(flake);
          flake.position.set(0,-1650, 1700);
          var crystal  = new THREE.Mesh( new THREE.SphereGeometry( 16, 24, 24 ),materialOne );
          flake.add(crystal);
          flake.rotation.x = 0.8;
          flake.rotation.y = -0.4;
          var flak = new THREE.Mesh( new THREE.CylinderGeometry(1, 1, 48, 12, 1), materialFour);
          flake.add( flak );
          flak.position.x = 20;
          flak.position.y = 24;
          flak.rotation.z = -0.3;
          crystal.position.y = 28;
          var fleek = new THREE.Mesh(new THREE.CylinderGeometry(0.5, 3, 16, 12, 4),materialTwo);
          crystal.add(fleek);
          fleek.position.z = 22;
          fleek.rotation.x = 1.6;
          var flonk = new THREE.Mesh( new THREE.CylinderGeometry(2, 2, 1, 12, 1), materialThree); 	
          crystal.add(flonk)
          flonk.rotation.x = 1.57;
          flonk.position.set(6,4,16);	
          flik = flonk.clone();
          crystal.add(flik);
          flik.rotation.x = 1.57;
          flik.position.set(-6,4,16);
          var flipt = new THREE.Mesh( new THREE.CylinderGeometry(10, 10, 14, 12, 1), materialFour); 
          crystal.add(flipt)
          flipt.position.y = 16;
          var flek = new THREE.Mesh( new THREE.RingGeometry( 10, 16, 24, 1 ), materialFour);
          flipt.add( flek );
          flek.position.y = -3;
          flek.rotation.x = 1.57;	
        }
        //--------------------------------------------------------------------
        function animate() {
            // debug.value = " ";          
            requestAnimationFrame( animate );  // rekursiver Aufruf der Animation	
          t = clock.getElapsedTime();  
          pointSystem.rotation.x += 0.004;   // Rotation erzeugt durch sichtbar/ nicht sichtbar die Schneeschauer
          flake.rotation.y = Math.sin(t);
          crystal.rotation.x  = (1+Math.sin(t+2))* -0.3 ;
          renderer.render( scene, camera );	 		
        }
        
  </script>
</body>
</html>