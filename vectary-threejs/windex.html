<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Slime Time</title>
  <link rel="stylesheet" href="css/main.css">
</head>
<body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r123/three.js"></script>
  <script src='./node_modules/three/examples/jsm/utils/threex.domevents.js'></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.70/Tone.js"></script>
  <script src="./js/obj.js"></script>
  <script src="./js/mtl.js"></script>


  <script type="module">
    import { OrbitControls } from './node_modules/three/examples/jsm/controls/OrbitControls.js';
    import { GLTFLoader } from './node_modules/three/examples/jsm/loaders/GLTFLoader.js';

    var scene = new THREE.Scene();

    var camera = new THREE.PerspectiveCamera(100, window.innerWidth / window.innerHeight, 11, 20000);
    camera.position.set(18,885, 2000);
    camera.lookAt(0, 0, 0);
    
    window.addEventListener('resize', () => {
      renderer.setSize(window.innerWidth,window.innerHeight);
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.outputEncoding = THREE.sRGBEncoding;
    })


    // var light = new THREE.HemisphereLight( 0xFFFFFF, 0xffffff, 0.75 )
    // // light.position.set(0,15,0);
    // scene.add(light);

    var light = new THREE.PointLight(0xFFFFFF, 2, 500)
    light.position.set(30,-15,-15);
    scene.add(light);
    
    const geometry9 = new THREE.SphereGeometry(1200, 33, 33)
    const material9 = new THREE.MeshPhongMaterial({color: "#ff0000", side: THREE.BacksSide})
    const universe = new THREE.Mesh(geometry9, material9)
    universe.position.set(0,0,0)
    scene.add(universe)

    var geo = new THREE.PlaneBufferGeometry(800, 800, 8, 8);
    const mat = new THREE.MeshPhongMaterial({color: '#4ff904', side: THREE.DoubleSide });
    var plane = new THREE.Mesh(geo, mat);
    plane.rotateX( - Math.PI / 2);
    plane.position.set(0, -125, 0)
    scene.add(plane);

  
    var beo = new THREE.PlaneBufferGeometry(800, 800, 8, 8);
    const bat = new THREE.MeshPhongMaterial({color: '#4ff904', side: THREE.DoubleSide });
    var plane = new THREE.Mesh(beo, bat);
    plane.rotateZ( - Math.PI / 2);
    plane.position.set(0, 275, -400)
    scene.add(plane);

    var ceo = new THREE.PlaneBufferGeometry(800, 800, 8, 8);
    const cat = new THREE.MeshPhongMaterial({color: '#4ff904', side: THREE.DoubleSide });
    var plane = new THREE.Mesh(ceo, cat);
    plane.rotateY( - Math.PI / 2);
    plane.position.set(400, 275, 0)
    scene.add(plane);

    var deo = new THREE.PlaneBufferGeometry(800, 800, 8, 8);
    const dat = new THREE.MeshPhongMaterial({color: '#4ff904', side: THREE.DoubleSide });
    var plane = new THREE.Mesh(deo, dat);
    plane.rotateY( - Math.PI / 2);
    plane.position.set(-400, 275, 0)
    scene.add(plane);

    var feo = new THREE.PlaneBufferGeometry(800, 800, 8, 8);
    const fat = new THREE.MeshPhongMaterial({color: '#4ff904', side: THREE.DoubleSide });
    var plane = new THREE.Mesh(feo, fat);
    plane.rotateX( - Math.PI / 2);
    plane.position.set(0, 675, 0)
    scene.add(plane);



    scene.fog = new THREE.Fog( 0x4ff904, 0, 2000 );
   

    var renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.setClearColor("#007a33");
    renderer.setSize(window.innerWidth,window.innerHeight);
    document.body.appendChild(renderer.domElement); 
    

    var young;
    var stoner;
    var life;
        

    const loader = new GLTFLoader();

    loader.load(
      // resource URL
      './scene.gltf',
      // called when the resource is loaded
      function ( gltf ) {
        scene.add( gltf.scene );
        gltf.scene.position.set(200,-100,0)
        gltf.scene.scale.set(10,10,10)
        gltf.scene.color = "#000000"
    })

    loader.load(
      // resource URL
      './scene.gltf',
      // called when the resource is loaded
      function ( gltf ) {
        scene.add( gltf.scene );
        gltf.scene.position.set(20,-100,0)
        gltf.scene.scale.set(10,10,10)
    })

    loader.load(
      // resource URL
      './scene.gltf',
      // called when the resource is loaded
      function ( gltf ) {
        scene.add( gltf.scene );
        gltf.scene.position.set(-170,-100,0)
        gltf.scene.scale.set(10,10,10)
    })

    

    var mtlLoader = new THREE.MTLLoader();
    mtlLoader.load('Y.mtl', function (materials) {


      materials.preload();

      var objLoader = new THREE.OBJLoader();
      objLoader.setMaterials(materials);
      objLoader.load('Y.obj', function (object) {
        scene.add(object);
        young = object;
        object.position.z = 33;
        object.position.y = 5;
        object.position.x = -200;
        object.rotation.z = 0;
        object.scale.set(1.15,1.15,1.15)
      });
    });

    var mtlLoader = new THREE.MTLLoader();
    mtlLoader.load('S.mtl', function (materials) {


      materials.preload();

      var objLoader = new THREE.OBJLoader();
      objLoader.setMaterials(materials);
      objLoader.load('S.obj', function (object) {
        scene.add(object);
        stoner = object;
        object.position.z = 33;
        object.position.y = 5
        object.position.x = 0;
        object.rotation.z = 0;
      });
    });

    var mtlLoader = new THREE.MTLLoader();
    mtlLoader.load('L.mtl', function (materials) {


      materials.preload();

      var objLoader = new THREE.OBJLoader();
      objLoader.setMaterials(materials);
      objLoader.load('L.obj', function (object) {
        scene.add(object);
        life = object;
        object.position.z = 33;
        object.position.y = 10;
        object.position.x = 180;
        object.rotation.z = 0;
      });
    });

    const geometry10 = new THREE.TorusKnotBufferGeometry( 2000, 220.3, 128, 64 )
    const material10 = new THREE.MeshPhongMaterial({color: "#ff0000", side: THREE.BacksSide})
    const snake = new THREE.Mesh(geometry10, material10)
    snake.position.set(0,0,0)
    snake.rotation.x = 5
    console.log(snake.geometry.parameters)
    scene.add(snake)

    const geometry11 = new THREE.TorusKnotBufferGeometry( 2000, 220.3, 128, 64 )
    const material11 = new THREE.MeshPhongMaterial({color: "#ff0000", side: THREE.BacksSide})
    const snake2 = new THREE.Mesh(geometry11, material11)
    snake2.position.set(0,0,0)
    scene.add(snake2)
   
    const geometry12 = new THREE.TorusKnotBufferGeometry( 2000, 220.3, 128, 64 )
    const material12 = new THREE.MeshPhongMaterial({color: "#ff0000", side: THREE.BacksSide})
    const snake3 = new THREE.Mesh(geometry12, material12)
    snake3.position.set(0,0,0)
    snake3.rotation.y = -2
    scene.add(snake3)

    const geometry = new THREE.SphereGeometry(20, 20, 20)
    const material = new THREE.MeshPhongMaterial({color: '#ff0000'})
    const mercury = new THREE.Mesh(geometry, material)
    mercury.position.set(0,300,0)
    scene.add(mercury)

    const geometry2 = new THREE.SphereGeometry(20, 20, 20)
    const material2 = new THREE.MeshPhongMaterial({color: "#ff0000"})
    const moon = new THREE.Mesh(geometry2, material2)
    moon.position.set(180,300,0)
    scene.add(moon)

    const geometry3 = new THREE.SphereGeometry(20, 20, 20)
    const material3 = new THREE.MeshPhongMaterial({color: "#ff0000"})
    const mars = new THREE.Mesh(geometry3, material3)
    mars.position.set(-200,300,0)
    scene.add(mars)

    const geometry4 = new THREE.SphereGeometry(100,100,100)
    const material4 = new THREE.MeshBasicMaterial({color: "#000000"})
    const sun = new THREE.Mesh(geometry4, material4)
    sun.position.set(0,520,0)
    scene.add(sun)



    const backsound = new Tone.Player("./hbsLoop.mp3").toDestination();
    const player = new Tone.Player("./fed.mp3").toDestination();
    // const player1 = new Tone.Player("./fed.mp3").toDestination();
    const player2 = new Tone.Player("./grat.mp3").toDestination();
    Tone.loaded().then(() => {
      Tone.context.resume();
    });

    Tone.context.resume();


    const domEvents = new THREEx.DomEvents(camera, renderer.domElement)

    domEvents.addEventListener(sun, 'click', event => {
      backsound.loop = true
      backsound.start()
    })
    domEvents.addEventListener(mercury, 'click', event => {
      player.start();
    })
    domEvents.addEventListener(moon, 'click', event => {
      // moon.scale.set(5,5,5)
      player2.start();
    })

    Tone.context.resume();
    
    domEvents.addEventListener(mars, 'click', event => {
      // mars.scale.set(15,15,15)
      player2.start();
    })

    // function keyLog() {
    //   document.onkeydown = function(e) {
       
    //   }
    // }
    // keyLog()

    var controls = new OrbitControls( camera, renderer.domElement );
    controls.minDistance = -900
    controls.maxDistance = 20000
    controls.enableDamping = true;
    controls.dampingFactor = 0.27;
    controls.target = new THREE.Vector3(0,0,-100);
    var centerPosition = controls.target.clone();
    centerPosition.y = 0;
    var groundPosition = camera.position.clone();
    groundPosition.y = 0;
    var d = (centerPosition.distanceTo(groundPosition));

    var origin = new THREE.Vector2(controls.target.y,0);
    var remote = new THREE.Vector2(0,d); // replace 0 with raycasted ground altitude
    var angleRadians = Math.atan2(remote.y - origin.y, remote.x - origin.x);
    controls.maxPolarAngle = angleRadians;
    
    document.addEventListener("keydown", onDocumentKeyDown, false);
    function onDocumentKeyDown(event) {
    var keyCode = event.which;
    // up
    if (keyCode == 40) {
        camera.position.z += 5;
        // down
    } else if (keyCode == 38) {
        camera.position.z -= 5;
        // left
    } else if (keyCode == 37) {
        camera.position.x -= 5;
        // right
    } else if (keyCode == 39) {
        camera.position.x += 5;
        // space
    } else if (keyCode == 32) {
        camera.position.x = 0.0;
        camera.position.y = 0.0;
    }
    // render();
};




    var r = 333;
    var theta = 0.2;
    var dTheta = 2 * Math.PI / 1000;
  

    const animate = () => {
      requestAnimationFrame(animate)

      // young.position.y += 0.10 
      // stoner.position.y += 0.20
      // life.position.y += 0.30
      mercury.rotation.z -= 0.01
      mercury.rotation.x -= 0.01

      // theta += dTheta;
      // moon.position.x = r * Math.cos(theta)
      // moon.position.z = r * Math.sin(theta)
      // mercury.position.x = r * Math.cos(theta) 
      // mercury.position.z = (r * Math.sin(theta))
      // mars.position.x = r * Math.cos(theta) 
      // mars.position.z = (r * Math.sin(theta) * -1)
      

      moon.rotation.x += 0.01
      moon.rotation.z += 0.01

      mars.rotation.x += 0.01
      mars.rotation.y += 0.01
      snake.rotation.y += 0.01
      snake2.rotation.z += 0.01
      snake3.rotation.x += 0.01

      controls.update();
      renderer.render(scene, camera)
    }

    animate()
    

    
  </script>
</body>
</html>