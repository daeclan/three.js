<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Slime Time</title>
  <link rel="stylesheet" href="css/main.css">
</head>
<body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r123/three.js"></script>
  <script src='./node_modules/three/examples/jsm/utils/threex.domevents.js'></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.70/Tone.js"></script>
  <script src="./js/obj.js"></script>
  <script src="./js/mtl.js"></script>


  <script type="module">
    import { OrbitControls } from './node_modules/three/examples/jsm/controls/OrbitControls.js';

    var scene = new THREE.Scene();

    var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    
    var light = new THREE.PointLight(0xFFFDDD, 2.4, 1000)
    light.position.set(0,15,15);
    scene.add(light);

    var light = new THREE.PointLight(0xFFFDDD, 2.4, 1000)
    light.position.set(30,-15,-15);
    scene.add(light);

    scene.fog = new THREE.Fog( 0x4ff904, 0, 750 );
   


    var renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setClearColor("#00ff00");
    renderer.setSize(window.innerWidth,window.innerHeight);
    document.body.appendChild(renderer.domElement); 

    

    var ourObj;
    var ourObj2;
    var ourObj3;

    var mtlLoader = new THREE.MTLLoader();
    mtlLoader.load('Y.mtl', function (materials) {

      // console.log(mtl.colorAmbient)

      materials.preload();

      var objLoader = new THREE.OBJLoader();
      objLoader.setMaterials(materials);
      objLoader.load('Y.obj', function (object) {
        scene.add(object);
        ourObj = object;
        object.position.z = -200;
        object.position.y = 0;
        object.position.x = 0;
        object.rotation.x = 90;

        // this.tl = new TimelineMax();
        // this.tl.from(ourObj.scale, 2, {y: 0, x: 0, z: 0, ease: Expo.easeOut});
      });
    });

    

    const geometry = new THREE.SphereGeometry(10, 10, 10)
    const material = new THREE.MeshNormalMaterial({wireframe: true})
    const sphere = new THREE.Mesh(geometry, material)
    scene.add(sphere)
    sphere.position.set(-120,0,-200)

    const geometry2 = new THREE.SphereGeometry(10, 10, 10)
    const material2 = new THREE.MeshNormalMaterial({wireframe: true})
    const sphere2 = new THREE.Mesh(geometry2, material2)
    sphere2.position.set(120,0,-200)
    scene.add(sphere2)

    // const geometry3 = new THREE.SphereGeometry(10, 10, 10)
    // const material3 = new THREE.MeshNormalMaterial({wireframe: true})
    // const sphere3 = new THREE.Mesh(geometry3, material3)
    // sphere3.position.x = -40
    // scene.add(sphere3)

    camera.position.z = 70

    const player = new Tone.Player("./fed.mp3").toDestination();
    // const player1 = new Tone.Player("./fed.mp3").toDestination();
    const player2 = new Tone.Player("./grat.mp3").toDestination();
    Tone.loaded().then(() => {
      Tone.context.resume();
    });

    Tone.context.resume();


    const domEvents = new THREEx.DomEvents(camera, renderer.domElement)

    console.log(domEvents)

    domEvents.addEventListener(sphere, 'click', event => {
      player.start();
    })
    domEvents.addEventListener(sphere2, 'click', event => {
      // sphere2.scale.set(5,5,5)
      player2.start();
    })

    // Tone.context.resume();
    
    // domEvents.addEventListener(sphere3, 'click', event => {
    //   sphere3.scale.set(15,15,15)
    //   player2.start();
    // })

    var controls = new OrbitControls( camera, renderer.domElement );
    controls.minDistance = 1
    controls.maxDistance = 1000

  

    const animate = () => {
      requestAnimationFrame(animate)

      ourObj.rotation.z += 0.01
      sphere.rotation.z -= 0.01
      sphere.rotation.x -= 0.01
      

      sphere2.rotation.x += 0.01
      sphere2.rotation.z += 0.01

      // sphere3.rotation.x += 0.01
      // sphere3.rotation.y += 0.01
      controls.update();
      renderer.render(scene, camera)
    }

    animate()

    
  </script>
</body>
</html>